package retorno

import (
	"testing"

	"github.com/padmoney/cobranca"
)

var fileSantander = `02RETORNO01COBRANCA       52252119466721194667PADMONEY                      033SANTANDER      18061800000000009889426                                                                                                                                                                                                                                                                                  233000001
1029999999900019152252119466721194667                         00027952                                     5061506182795      0002795200          10061800000000327000330000002000000000013000000000000000000000000000000000000000000000000000000000000000000000000003373400000000010340000000000000 N 180618Pavel Chekov                         00000000000000000000000000000000000033734C           231000002
1029999999900019152252119466721194667                         00176796                                     50218061817679     0017679600          19061800000000081500330000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 N 180618Wesley Crusher                       00000000000000000000000000000000000000000C           233000003
1029999999900019152252119466721194667                         00176801                                     50218061817680     0017680100          20061800000000077000330000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 N 180618Hikaru Sulu                          00000000000000000000000000000000000000000C           233000004
1029999999900019152252119466721194667                         00176818                                     50218061817681     0017681800          19061800000000015430330000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000600 N 180618Montgomery Scott                     00000000000000000000000000000000000000000C           233000005
1029999999900019152252119466721194667                         00064939                                     5101506186493      0006493900          10041800000000216000334316802000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 N 150618Christopher Pike                     00000000000000000000000000000000000000000C           231000006
1029999999900019152252119466721194667                         00176834                                     50218061817683     0017683400          19061800000000045000330000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 N 180618Jean-Luc Picard                      00000000000000000000000000000000000000000C           233000007
1029999999900019152252119466721194667                         00176842                                     50118061817684     0017684200          19061800000000202750330000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 N 180618Leonard McCoy                        00000000000000000000000000000000000000000C           233000008
1029999999900019152252119466721194667                         00176850                                     50318061817685     0017685000          19061800000000035000330000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 N 180618James T. Kirk                        00000000000000000000000000000000000000000C           233000009
1029999999900019152252119466721194667                         00176869                                     52818061817686     0017686900          21061800000000081500330000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 N 180618Nyota Uhura                          00000000000000000000000000000000000000000C           233000010
1029999999900019152252119466721194667                         00176877                                     57218061817687     0017687700          19061800000000035000330000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 N 180618Philippa Georgiou                    00000000000000000000000000000000000000000C           233000011
9201033          000053920000013591265700000132                                                  000000000000000000000000000000          000000000000000000000000000000                                                                                                                                                                                                                                233000012
`

func TestSantanderCNAB400Conteudo(t *testing.T) {
	r, err := New(cobranca.CodigoSantander, CNAB400)
	if err != nil {
		t.Errorf("There should not be an error, error: %s", err)
	}
	registros, err := r.ReadFile([]byte(fileSantander))
	if err != nil {
		t.Errorf("There should not be an error, error: %s", err)
	}
	if len(registros) != 10 {
		t.Errorf("Expected '%d', got '%d'", 10, len(registros))
	}

	r1 := registros[0]
	nn1 := "000000002795-2"
	if r1.NossoNumero != nn1 {
		t.Errorf("Expected '%s', got '%s'", nn1, r1.NossoNumero)
	}
	v1 := 327.0
	if r1.Valor != v1 {
		t.Errorf("Expected '%f', got '%f'", v1, r1.Valor)
	}
}
